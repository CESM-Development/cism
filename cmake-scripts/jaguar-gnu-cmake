# Compared to the PGI build, I executed:
#   module swap PrgEnv-pgi PrgEnv-gnu
#   module load netcdf/4.1.2
#
# cmake configuration script that works on jaguar with GCC 
# This script needs to be run from a subdirectory (e.g. build-gnu)
# of the main seacism repository (reflected in the several 
# instances of # ".." below).
#
# After this executes, do:
#   make -j 8
#   cp example-drivers/simple_glide/src/sgcmake .

rm ./CMakeCache.txt

echo
echo "Auto-generating  glide_io.F90, glide_lithot.F90, and glimmer_vers.F90"
pushd ../libglide
 python ../scripts/generate_ncvars.py glide_vars.def ../libglimmer/ncdf_template.F90.in 
 python ../scripts/generate_ncvars.py glide_lithot_vars.def ../libglimmer/ncdf_template.F90.in 
popd
pushd ../libglimmer
sed -f svnversion.sed glimmer_vers.F90.in > glimmer_vers.F90
popd


echo
echo "Doing CMake Configuration step"

cmake \
  -D GLIMMER_TRILINOS_DIR=/ccs/proj/cli054/trilinos-10.10.1/GCC_BUILD/include \
  -D GLIMMER_NETCDF_DIR=$NETCDF_DIR \
  -D CMAKE_VERBOSE_MAKEFILE:BOOL=ON \
  -D GLIMMER_Fortran_FLAGS="-ffree-line-length-none" \
 ..

# Note: last argument above  ".."  is path to top seacism directory 
