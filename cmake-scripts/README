README file for cmake-scripts

This is a collection of scripts that have been used successfully
to build simple_glide using the CMake build system instead of
autoconf. The two build systems can live side-by-side.

These scripts have been contributed by several different users,
and are generally intended to support building simple_glide in
a few different ways.

See the 'builds' directory for cmake-based builds that are more
turnkey, and provide simpler support for a wide range of build
options.  Currently, the builds directory provides support for
a limited number of machines/architectures.


Cmake Overview

In the top directory and some source directories, there are files
called CMakeLists.txt (analagous to Makefile.am).

The scripts in this directory invoke the cmake command, which is
analagous to configure.

With CMake, the build is out-of-source. That means the
*.o and *.mod files generated during compilation live in
the build tree and do not clutter the source tree (that 
comes from svn). (The build tree has the same structure as the
source tree.)


Building Using These Scripts

From the top seacism directory, make a build directory such
as  "build-pgi". Copy the appropriate cmake script into that
directory, modify paths to Trilinos and Netcdf if necessary.
Run the script, then run make. CMake handles dependencies
very well, so you can do   "make -j 8" for parallel 
compilation (where you can adjust 8 to the number of cores 
on the compile machine).

Many paths, flags, and settings are pulled from the installed 
Trilinos build. This keeps the glimmer cmake scripts small and
helps keep consistent versions of compilers, lapack, etc. 
A side-effect of this is that this build system only works
with builds against an installed Trilinos.

See document-cmake-options for a list of cmake "-D" options
recognized by the build system.


Other Files In The cmake-scripts Directory

There are also several auto* files in this directory, that are
used to handle some non-standard source files in the CISM code
base.  These include glide_vars.def, glint_vars.def, eis_vars.def,
glint_mbal_vars.def, and glimmer_vers.F90.cmake.in.  The autogen*
scripts are used to generate .F90 files from these files. The
autocopy* scripts are used to copy already-autogenerated source
files.  How these are used depends on whether or not CISM is
being built as part of CESM.  These scripts are invoked when cmake
processes the main CMakeLists.txt file.  Which scripts get used
mainly depends on the setting of the cmake variable
CISM_USE_DEFAULT_IO.



Andy, 6/1/2012, 6/22/2012
Updated: 10/8/2013 -DMR
