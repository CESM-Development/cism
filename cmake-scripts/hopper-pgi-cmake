# Requires (command line or in  .bashrc):
#   module load cmake
#
# cmake configuration script that works on hopper with PGI
# This script needs to be run from a subdirectory (e.g. build-pgi)
# of the main seacism repository (reflected in the several 
# instances of # ".." below).
#
# After this executes, do:
#   make -j 4
#   cp example-drivers/simple_glide/src/sgcmake .
#  --If you get an error about missing mod files, try make multiple times.

#module unload modules

#module unload cmake
#module unload PrgEnv-cray PrgEnv-gnu PrgEnv-intel PrgEnv-pathscale PrgEnv-pgi
#module unload hdf5-parallel
#module unload netcdf
#module unload python
#module unload cray-shmem
#module unload cray-mpich2

#module load modules/3.2.6.6
#module load cmake/2.8.7
#module load PrgEnv-pgi/4.0.46
#module load hdf5-parallel/1.8.8
#module load python/2.7.1
#module load cray-shmem/5.5.2
#module load cray-mpich2/5.5.2

rm ./CMakeCache.txt

echo
echo "Doing CMake Configuration step"

cmake \
  -D GLIMMER_TRILINOS_DIR=/scratch/scratchdirs/evanskj/trilinos-10.12.2-Source/xe6-pgi/install \
  -D GLIMMER_NETCDF_DIR=$CRAY_NETCDF_DIR \
  -D GLIMMER_FMAIN="/opt/pgi/12.5.0/linux86-64/12.5/lib/f90main.o" \
  -D CMAKE_VERBOSE_MAKEFILE:BOOL=OFF \
 ..

# Note: last argument above  ".."  is path to top seacism directory 
 
# If you dont depend on  netcdff AND netcdf, but just netcdf, use this line
#   -D GLIMMER_NETCDF_LIBS="netcdf" \
#
# 9/27/2012 this the PrgEnv that both the trilinos build above and the current
# successful build and run of seacism on Hopper xe6

#Currently Loaded Modulefiles:

